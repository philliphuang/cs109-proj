<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>CS109a Project: You Are What You Eat</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/scrolling-nav.css" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<!-- The #page-top ID is part of the scrolling feature - the data-spy and data-target are part of the built-in Bootstrap scrollspy function -->

<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top" onload="document.body.style.opacity='1'">

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <!-- <a class="navbar-brand page-scroll" href="#page-top">You Are What You Eat</a> -->
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    <!-- Hidden li included to remove active class from about link when scrolled up past about section -->
                    <li class="hidden">
                        <a class="page-scroll" href="#page-top"></a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#about">about</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#overview">overview</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#data">data</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#models">models</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="#results">results</a>
                    </li>  
                    <li>
                        <a href="https://github.com/philliphuang/cs109-proj">
                            <i class="fa fa-github" aria-hidden="true"></i>
                        </a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Intro Section -->
    <section id="intro" class="intro-section">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class = 'title' id="title">
                        <span class='title1'>YOU</span>
                        <span class='title2'>ARE</span>
                        <span class='title3'>WHAT</span>
                    </div>
                    <div class = 'title' id="title">
                        <span class='title4'>YOU</span>
                        <span class='title5'>EAT.</span>
                    </div>
                    <div class='subtitle'>THE EFFECTS OF DIET ON HEALTH</div>
                    <!-- <p><strong>Usage Instructions:</strong> Make sure to include the <code>scrolling-nav.js</code>, <code>jquery.easing.min.js</code>, and <code>scrolling-nav.css</code> files. To make a link smooth scroll to another section on the page, give the link the <code>.page-scroll</code> class and set the link target to a corresponding ID on the page.</p> -->
                </div>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="content about-section">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h1>about</h1>
                    <p class="normal_text">This was the final project for Harvard University’s CS109a: Data Science course taught during the Fall 2016 semester. The team members include Christopher Chen, Joshua Felizardo, Phillip Huang, and Harry Xue. We would like to thank Steve Klosterman for his guidance as the advising teaching fellow for this project. 
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Background Section -->
    <section id="overview" class="content overview-section">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h1 class="section_title">overview</h1>
                    <h2 class="subsection"><i class="fa fa-lightbulb-o" aria-hidden="true"></i>  Motivation</h2>
                    <p class="normal_text">In recent years, the healthcare industry has become increasingly focused on a preventative model. Health and food are constantly discussed hand in hand, with numerous foods and diets being proclaimed as surefire ways to a healthy lifestyle. However, how should one determine which foods are linked with better health?</p>

                    <h2 class="subsection"><i class="fa fa-globe" aria-hidden="true"></i>   Global Approach</h2>
                    <p class="normal_text">Individual humans make poor (and oftentimes unethical) experiment participants, since it is virtually impossible for an experimenter to control for all other variables besides one food product. Therefore, we decided to tackle the issue from a more global perspective, looking at national supplies of many different food types and relating them to national averages for risk of death from noncommunicable diseases such as cancer, diabetes, and heart disease, where better health comes with lower rates for both. We hope that using national average data will account for the variation in individual members of the population. </p>

                    <h2 class="subsection"><i class="fa fa-calculator" aria-hidden="true"></i> Statistical Tools</h2>
                    <p class="normal_text">Because of the continuous nature of our predictors - the amounts of each food type in each country in various years - and the response variables - the risk of death measures - we can use linear regression and its extensions to identify whether specific food types or combinations of foods have a significant relationship, whether positive or negative, to risk of death.</p>

                </div>
            </div>
        </div>
    </section>

    <!-- Data Section -->
    <section id="data" class="content data-section">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h1>data</h1>
                    <h2 class="subsection"><i class="fa fa-database" aria-hidden="true"></i> Data Sources</h2>
                    <div class="col-md-4">
                        <h3 class="ssubsection">Food</h3>
                        <p class="normal_text">For the different food categories, we utilized two datasets from the Food and Agriculture Organization of the United Nations (FAO), which contained crops and livestock raised primarily for human consumption, respectively. While different units were provided, we focused on amounts measured in grams per capita per day for different countries from 1961-2013 for simplicity and comparability. While some countries without reported data were given estimated figures, there was a significant amount of missing data from both datasets.</p>
                    </div>
                    <div class="col-md-4">
                        <h3 class="ssubsection">Disease</h3>
                        <p class="normal_text">For the risk of death from noncommunicable diseases, we used a dataset from the World Health Organization (WHO), which measured risk of death with two different measures, calculated in 2000 and 2012. One was an age-standardized mortality rate, computed by weighting mortality rates for different age groups to the standard WHO population, per 100,000 people. They also calculated the percentage of 30 year old individuals who would die before reaching 70 years of age because of a non-communicable disease. While estimates were also provided for countries without data, there was still some presence of missing data.</p>
                    </div>
                    <div class="col-md-4">
                        <h3 class="ssubsection">Healthcare and Exercise</h3>
                        <p class="normal_text">We also wanted to take into account other potential factors that may affect health. We focused on assessing the impact of exercise and the quality of healthcare in each country. As a proxy for healthcare quality, we drew data documenting the number of physicians per 1000 people in each country from the WHO’s Global Health Workforce Statistics, the Organisation for Economic Co-operation and Development (OECD). We also obtained data about the number of hospital beds per 1000 people in each country from the same source. For exercise, we analyzed the WHO’s dataset on the percentage of individuals with insufficient physical activity for each country. The WHO defines insufficient physical activity as less than 150 minutes of moderate physical activity or less than 75 minutes of vigorous physical activity.</p>
                    </div>

                    <h2 class="subsection"><i class="fa fa-shower" aria-hidden="true"></i> Data Cleaning</h2>
                    <h3 class="ssubsection">General Cleaning</h3>
                    <p class="normal_text">General cleaning is performed in Notebook 1. Some datasets were provided in multiple versions. The cleanest version that contained all relevant values was selected for the project. Each dataset was read into a pandas DataFrame, and redundant, inconsistent, and invalid values were stripped out. Each dataset was then compressed to contain only the values relevant to the guiding questions of the project. This included omitting gender-specific data, country codes, and food item codes. It also included grouping data by item id, in order, for example, to have a single item per column and a single country per row for the food data. Grams per capita per day was selected as the main unit of measuring food consumption as it was calculated on per capita basis, which is relevant to the impact on an individual's health. 
                    One particularly difficult problem we countered was that the country names were inconsistent across several of the datasets. For example, certain datasets encoded China as “China, People’s Republic of” while other datasets encoded it as “China, mainland.” To resolve these inconsistencies, we manually edited all dataset country names to match the country names in our dependent variable, the disease data. Countries not appearing in the disease data were omitted.   </p>
                    
                    <h3 class="ssubsection">Imputation of Missing Values</h3>
                    <p class="normal_text">The imputation of missing values is performed in Notebook 2 and Notebook 3. 
                    Most datasets in this project, with the exception of the disease data, had a high prevalence of missing data. This is likely due to difficulty collecting information in certain countries. Several methods were attempted to handle these missing values. We first focus on the food data, as it the main information upon which we base our analyses. Dropping countries with many missing variables was attempted, but eliminated so many countries that statistical analysis was rendered infeasible. Next, dropping variables that had many missing countries was attempted, but similar problems occurred. A combination of dropping variables and countries was attempted by exploring how many countries with scarce data remained when sparse variables were dropped, and vice versa. The relationship between these two actions was explored and the quantities were plotted. In the end, we abandoned this method of imputation because too many years and countries would be dropped at each point.</p>
                    <p class="normal_text">We eventually settled on a method of imputing the missing data that is described as follows: average the food values over a thirty year period (30 years was chosen because one of the disease variables represented the risk of NCD at age 30) for every country for every food item. This eliminated year as a variable in the dataset. This is reasonable because year-to-year changes in food consumption unlikely have an effect on overall health. We still preserve the between-country differences in consumption. By averaging, we can “smooth over” the missing values for any given country for a given food item. As long as a few values exist for a few years and the consumption levels remain relatively stable over time, the years with missing data will not majorly impact the average value. Additional filled in years will only increase the accuracy of the average value over 30 years. After averaging, any remaining countries and food items with over 50% missing values were dropped. The remaining missing values were imputed with the global mean (averaging over all countries) for that value. We selected the global mean to impute because it has a very minimal impact on the results of the analysis. The global mean is conservative in its bias because imputing by any other value would skew the overall distribution of the values across countries higher or lower. Imputing by the global mean will only decrease the variance of the distribution, and thus will only make the effect of any given food item on health appear weaker.</p>

                    <h3 class="ssubsection">Elimination of Faulty Variables</h3>
                    <p class="normal_text">Elimination of faulty variables is implemented in Notebook 7. During the course of this project, the FAO revised their website to include variable descriptions for each of the food items in the crop and livestock data. Inspecting these descriptions revealed to us that many of the food items overlapped and several were incorrectly defined. For example, both “Sugar, Raw Equivalent” and “Sugar (Raw Equivalent)” were included as food items in the FAO dataset, but they were defined differently in their descriptions, with each containing a different set of food subcategories.</p>
                    <p class="normal_text">Clearly, using these food items will completely confounded our results for our statistical models. So, we manually checked and eliminated all the variables that were redundant, incorrectly defined, or completely ambiguous in content. We found Metadata on the dataset through the FAO website. We analyzed what subcategories that each variable contained, and manually dropped the variables whose subcategories overlapped with those of other variables. This helped reduce the multicollinearity and increase the accuracy and interpretability of the final model.</p>

                    <p class="normal_text">Cleaning of healthcare data can be found in Notebook 13.</p>

                    <h2 class="subsection"><i class="fa fa-search" aria-hidden="true"></i> Data Analysis and Visualization</h2>
                    <p class="normal_text">Visualization code can be found in Notebook 4. Correlation analysis can be found in Notebook 5. PCA analysis can be found in Notebook 15.</p>
                   
                    <h3 class="ssubsection">Exploratory Visualization with Interactive Choropleths</h3>
                    <p class="normal_text"> With such a large number of predictors and global data, it can be somewhat challenging to get a sense of the full picture through standard visualizations like simple bar graphs. Therefore, we created interactive choropleth visualizations using <a href="https://plot.ly/">Plotly</a> which heatmap food consumption as well as health data. The full interactive choropleths can be run offline by downloading and running Notebook 4.</p>

                    <img src="img/deaths_per_100k.png" style="width:80%">
                    


                    <h3 class="ssubsection">Correlation Analysis</h3>
                    <p class="normal_text">In our correlation analysis we already identified some of the potential categorization issues that we addressed in our extensive data cleaning section, as overlapping categories tended to have high correlation with each other. When comparing with the noncommunicable disease measures, none of the features appeared to be highly correlated with them, which was an encouraging sign to begin the model fitting and analysis once cleaning was complete.</p>

                    <h2 class="subsection">Further Exploratory Visualization</h3>

                    <h3 class="ssubsection">Nearest Neighbors</h3>
                    <p class="normal_text">Inspired by the k-nearest neighbors (KNN) algorithm covered in class, we decided to visualize the similarity of countries’ diets by a nearest neighbors approach. Using by-country average food consumption data from 1970-2000, we calculated the Euclidean distance between every pair of countries using each food item as a feature. Then we created a network graph with countries represented by nodes, edges drawn between countries if they were among the 3 nearest neighbors to one another and the length of the edges representing the Euclidean distance between linked countries in terms of food consumption habits. An interactive force-graph visualization of this can be found below:</p>

                    <iframe src="Net.html" style="width:100%; min-height: 75em"></iframe>
                    <p class="normal_text">We see that for the most part there are some geographical correlations in that countries near one another in graph proximity (and hence with similar diets) are geographically close in the real world but there are some interesting outliers as well.</p>

                    <h3 class="ssubsection">PCA</h3>
                    <p class="normal_text">We used PCA as another way of visualizing diet similarities between countries. PCA is commonly used to convert data with a large number of possibly correlated features into a set of orthogonal variables called principal components. Each principal component captures the largest possible variance possible. PCA was a natural fit for our data especially given the large number of food categories that we were dealing with. </p>
                    <img style="width:70%; height:70%" src="img/pca/pca2d.png">
                    <p class="normal_text">We visualized projections of the data onto the first 2 and first 3 principal components: An interactive visualization of the latter can be viewed below (<i>try clicking, dragging, and zooming</i>):</p>
                    <div id="PCA" style="width:100%; min-height:75em; padding-bottom: 2em"></div>
                    <p class="normal_text">PCA components are not always easily interpretable depending on the application. However, in our case there does happen to be an intuitive interpretation. Since each PCA component is a linear combination of the original features, then in this case each component can be interpreted as a particular "diet". Therefore we looked at the “diet” associated with each of the first 3 components, filtering out only loadings with values greater than 0.1 in absolute value for readability.</p>

                    <div class="row">
                        <div class="col-md-4"><img src="img/pca/pca1.png" style="width:100%;"></div>
                        <div class="col-md-4"><img src="img/pca/pca2.png" style="width:100%;"></div>
                        <div class="col-md-4"><img src="img/pca/pca3.png" style="width:100%;"></div>
                    </div>

                    <p class="normal_text">The loadings seem to support the hypothesis that the first component is associated with how developed a country is. Looking at the loadings for the first component we see that foods such as sugar, cocoa (probably a proxy for chocolate products), beer and meats are associated with more developed countries while staples such as rice and pulses (legumes) are associated with the less developed countries on the right of the 2d projection graph.</p>
                    <p class="normal_text">The other two components are not as easily interpretable, though the first component is nonetheless very interesting indeed.</p>

                </div>


            </div>
        </div>
        

        <!-- <div id="PCA" style="width:100%;height:100%"></div> -->
    </section>

    <!-- Models Section -->
    <section id="models" class="content models-section">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h1>models</h1>
                    <h2 class="subsection"><i class="fa fa-check" aria-hidden="true"></i> Scoring</h2>
                    <p class="normal_text">While we used Leave One Out cross validation to identify the best hyperparameters for the more advanced models (i.e. Lasso, Random Forests), we also utilized the food data from 2000-2012 as well as the noncommunicable disease data from 2012 to calculate predictive accuracy on our models, comparing their predictions on the 2000-2012 food data to the actual 2012 disease data using R^2. With R^2 values for each model we then could compare the predictive accuracy of each of the approaches to identify which one we would use for the final model.</p>

                    <h2 class="subsection"><i class="fa fa-line-chart" aria-hidden="true"></i> Least-squares Linear Regresssion</h2>
                    <p class="normal_text">The linear regression model can be found in Notebook 8.
                    As a preliminary method, Multiple Linear Regression made a lot of sense considering the continuous nature of our features (different food categories measured in grams/capita/day) and our responses (measured in percent and mortality rates). One of the method’s main advantages is that we could determine the most important features, as well as their predicted effect on the different diseases measures, relatively easily. We fit multiple linear regression models with the food data as the independent variables and the different disease datasets as the dependent variables. In terms of prediction accuracy these models performed reasonably well, although there were some potential issues that we noticed after fitting these models.</p>

                    <h2 class="subsection"><i class="fa fa-circle-o-notch" aria-hidden="true"></i> Lasso Regression</h2>
                    <p class="normal_text">The lasso regression model can be found in Notebook 9. One of the main issues that we noticed in our analysis of our initial models is the high-dimensionality of our features (relative to our observations) as well as the potential presence of multicollinearity, even after we performed cleaning on the food data. Our main strategy to address was variable selection in the form of Lasso Regression. Because it shrinks the coefficients to 0, it allows us to reduce the number of features while also still giving interpretable results. Moreover, in terms of prediction accuracy these models outperformed all the others, leading us to choose this approach to fit our final models.</p>

                    <h2 class="subsection"><i class="fa fa-exchange" aria-hidden="true"></i> Linear and Lasso with Log Transformations</h2>
                    <p class="normal_text">The models with log transformations can be found in Notebook 10. Another potential issue that we noted was the seeming lack of normality in the residuals for most of the Multiple Linear Regression and Lasso Regression models. One way we attempted to address that was by performing a logarithmic transformation on the different response datasets, excluding percent risk of death because of the potential loss of interpretability. Since percent risk already ranges from 0 to 100, there would be no need to apply a logarithmic transformation to the data. Although the transformations addressed the issue of normality in the residuals somewhat, prediction accuracy ended up being much worse once we back-transformed the predicted responses.</p>


                    <h2 class="subsection"><i class="fa fa-tree" aria-hidden="true"></i> Trees and Random Forests</h2>
                    <p class="normal_text">The tree and random forest models can be found in Notebook 11. One other approach we explored was the use of Tree and Random Forest Regression, an approach that does not rely on any major assumptions and is also relatively interpretable. One downside is that while we can identify important features in each tree and forest, we cannot easily determine whether those features lead to better or worse percent risk of death or mortality rate from noncommunicable diseases. Moreover, in terms of prediction accuracy these models did not outperform Multiple Linear Regression or Lasso.</p>
   
                </div>
            </div>
        </div>
    </section>

    <!-- Results Section -->
    <section id="results" class="content results-section">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h1>results and conclusion</h1>
                </div>
                <h2 class="subsection">Results</h2>
                <div class="col-md-6">
                    <h2 class="subsection" style="text-align: center">Deaths per 100k People</h2>
                    <img src="img/lasso/lasso_100k.png">
                </div>
                <div class="col-md-6">
                    <h2 class="subsection" style="text-align: center">Cancer Deaths per 100k People</h2>
                    <img src="img/lasso/lasso_cancer.png">
                </div>
             </div>
             <div class="row">
                <div class="col-md-6">
                    <h2 class="subsection" style="text-align: center">Cardiovascular Deaths per 100k People</h2>
                    <img src="img/lasso/lasso_cardio.png">
                </div>

                <div class="col-md-6">
                    <h2 class="subsection" style="text-align: center">Diabetes Deaths per 100k People</h2>
                    <img src="img/lasso/lasso_diabetes.png">
                </div>
             </div>
             <div class="row">
                <div class="col-md-6">
                    <h2 class="subsection" style="text-align: center">Respiratory Deaths per 100k People</h2>
                    <img src="img/lasso/lasso_resp.png">
                </div>
                <div class="col-md-6" style="padding-bottom: 5em">
                    <h2 class="subsection" style="text-align: center">Risk of Death at Age 30</h2>
                    <img src="img/lasso/lasso_risk.png">
                </div>
                <h2 class="subsection">Conclusions</h2>
                <p class="normal_text">For our final models, because of their high predictive accuracy and despite the potential concerns about their assumptions, we decided to use the Lasso Regression models. When identifying the significant food categories, we decided to use a significance threshold of 0.1 instead of the standard 0.05 so we could potentially visualize more important features. Especially with Lasso, at a significance level of 0.05 we had very few predictors that were deemed significant in the model, so using 0.1 as the threshold instead allowed us to identify more important categories, while still using a relatively robust approach.</p>
                <p class="normal_text">To visualize the predicted effects of these important food categories, we decided to use bar graphs with each food category along the x-axis and their respective coefficient values along the y-axis. One important thing to note is that the graphs can be counterintuitive: because the responses were measures of percent risk and mortality rate, a category with a positive coefficient value is associated with higher risk and mortality rate and thus could be considered an “unhealthy” food, while those with negative coefficient values are associated with lower risk and mortality rate and thus would be preferred for better health. </p>
                <p class="normal_text">Many of the results here are unsurprising to a layperson’s interpretation of nutrition. Various meats, like mutton or meat from horses, rabbits, camels, and other miscellaneous animals (represented by the Meats, other category) are strong predictors of cancer deaths. This is consistent with the <a href="http://www.aicr.org/reduce-your-cancer-risk/recommendations-for-cancer-prevention/recommendations_05_red_meat.html">scientific consensus</a> that red meats may increase cancer risk. Diabetes is predicted by consumption of carbohydrates like sugar and starches, which is consistent with the intuitive expectation that foods that impact blood sugar will have a strong effect. Several oils predict deaths by cardiovascular disease. One may hypothesize that this might be due to the high fat content. </p>
                <p class="normal_text">Some of the results are not as intuitive. Pulses apparently predict respiratory disease, while oranges are strong protectants against cardiovascular disease. There may exist biological explanations of these effects, but it is difficult to definitively discern them from errors in the data or statistical noise from the information we have here.</p>

                <h2 class="subsection">Other Factors and Extensions</h2>
                <p class="normal_text">While the main focus of our project was identifying which food categories had significant effects on risk of death or mortality rate from noncommunicable diseases, we also explored the potential effects of other factors on the unexplained variance from our final Lasso models. To determine whether there was a significant relationship, we performed Simple Linear Regression with national exercise data as well as the number of doctors and available hospital beds per 1000 people per country as features and the residuals from those Lasso models as responses. However, we did not reach any significant conclusions from those follow-up models, partly because of the sparsity of our feature values and their inconsistent units when compared to the food and disease data. Still these factors are by no means insignificant and should be explored further in follow-up work.</p>

                <p class="normal_text">As we saw in some of our data visualizations, development levels of countries could potentially be another important factor to consider when predicting noncommunicable disease risk and mortality, perhaps through GDP or other measures. Moreover, for many of these noncommunicable diseases there could certainly be genetic factors that could also be potentially be tied to country or region. If genetic markers significantly associated with each disease could be identified and measured in each country, then that would certainly be another factor to take into account as well.</p>
            </div>
        </div>
    </section>

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

    <!-- Scrolling Nav JavaScript -->
    <script src="js/jquery.easing.min.js"></script>
    <script src="js/scrolling-nav.js"></script>
    <!-- font awesome  -->
    <script src="https://use.fontawesome.com/c5a1a325e9.js"></script>

    <!-- plotly -->
    <script src="js/plotly-latest.min.js"></script>
    <script src="js/visualizations.js"></script>

    <!-- w3 import html snippet -->
    <script src="http://www.w3schools.com/lib/w3data.js"></script>


</body>

</html>
